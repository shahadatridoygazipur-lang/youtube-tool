<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bulk Playlist Manager üöÄ</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');

    body {
      margin: 0;
      font-family: "Poppins", sans-serif;
      background: linear-gradient(135deg, #0f172a, #1e293b, #334155);
      color: #e2e8f0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      overflow: hidden;
    }

    .glass {
      background: rgba(255, 255, 255, 0.1);
      box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 30px;
      text-align: center;
      width: 90%;
      max-width: 600px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      display: flex;
      flex-direction: column;
      max-height: 90vh;
    }

    h1 { color: #38bdf8; font-weight: 600; margin-bottom: 10px; font-size: 1.5rem; }
    
    .input-group { margin-bottom: 15px; text-align: left; }
    label { font-size: 12px; color: #94a3b8; margin-left: 5px; }

    input, textarea {
      width: 100%;
      padding: 12px;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,0.1);
      background: rgba(0, 0, 0, 0.2);
      color: #fff;
      font-size: 13px;
      margin-top: 5px;
      box-sizing: border-box;
    }
    
    textarea { resize: none; height: 120px; font-family: monospace; }
    input:focus, textarea:focus { border-color: #38bdf8; outline: none; }

    .btn-container { display: flex; gap: 10px; margin-top: 10px; }

    button {
      flex: 1;
      padding: 12px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 600;
      transition: 0.3s;
    }

    .btn-auth { background: #fff; color: #333; display: flex; align-items: center; justify-content: center; gap: 8px; }
    .btn-add { background: linear-gradient(90deg, #0ea5e9, #38bdf8); color: #0f172a; }
    
    button:hover { transform: translateY(-2px); opacity: 0.9; }
    button:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }

    /* ‡¶≤‡¶ó ‡¶è‡¶∞‡¶ø‡ßü‡¶æ ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® */
    #logArea {
      margin-top: 15px;
      background: rgba(0, 0, 0, 0.3);
      padding: 10px;
      border-radius: 10px;
      height: 150px;
      overflow-y: auto;
      text-align: left;
      font-size: 12px;
      border: 1px solid rgba(255,255,255,0.05);
    }
    .log-item { margin-bottom: 5px; border-bottom: 1px solid rgba(255,255,255,0.05); padding-bottom: 2px; }
    .success { color: #4ade80; }
    .error { color: #f87171; }
    .processing { color: #facc15; }

    /* Scrollbar */
    #logArea::-webkit-scrollbar { width: 6px; }
    #logArea::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }
  </style>
  
  <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body>

  <div class="glass">
    <h1>üöÄ Bulk Playlist Manager</h1>

    <div class="input-group">
      <label>‡¶ü‡¶æ‡¶∞‡ßç‡¶ó‡ßá‡¶ü ‡¶™‡ßç‡¶≤‡ßá‡¶≤‡¶ø‡¶∏‡ßç‡¶ü ID:</label>
      <input type="text" id="playlistId" placeholder="‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£: PLxA6_w... (ID only)">
    </div>

    <div class="input-group">
      <label>‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶≤‡¶ø‡¶Ç‡¶ï (‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶≤‡¶æ‡¶á‡¶®‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶ï‡¶∞‡ßá):</label>
      <textarea id="videoInput" placeholder="https://youtu.be/video1&#10;https://youtu.be/video2&#10;https://youtu.be/video3..."></textarea>
    </div>

    <div class="btn-container">
      <button id="authBtn" class="btn-auth" onclick="handleAuth()">
        <img src="https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg" width="18"> Google Login
      </button>
      <button id="addBtn" class="btn-add" onclick="startBulkProcessing()" disabled>
        Start Adding All ‚ö°
      </button>
    </div>

    <div id="logArea">
      <div style="color: #94a3b8; text-align: center;">‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶™‡¶∞ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá...</div>
    </div>
  </div>

  <script>
    // ‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶∏‡¶†‡¶ø‡¶ï Client ID
    const CLIENT_ID = '197847606984-8jcne8ar7h1q7i3spaqic5atsdf3on8v.apps.googleusercontent.com';
    
    let tokenClient;
    let accessToken = null;

    window.onload = function() {
      tokenClient = google.accounts.oauth2.initTokenClient({
        client_id: CLIENT_ID,
        scope: 'https://www.googleapis.com/auth/youtube',
        callback: (tokenResponse) => {
          if (tokenResponse && tokenResponse.access_token) {
            accessToken = tokenResponse.access_token;
            document.getElementById("authBtn").innerText = "Logged In ‚úÖ";
            document.getElementById("authBtn").style.background = "#4ade80";
            document.getElementById("addBtn").disabled = false;
            addLog("System Ready! ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶¶‡¶ø‡ßü‡ßá Start ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ö‡¶æ‡¶™‡ßÅ‡¶®‡•§", "success");
          }
        },
      });
    };

    function handleAuth() {
      if (accessToken) return;
      tokenClient.requestAccessToken();
    }

    // ==========================================
    // BULK PROCESSING LOGIC
    // ==========================================
    async function startBulkProcessing() {
      const videoInput = document.getElementById("videoInput").value;
      const playlistId = document.getElementById("playlistId").value.trim();
      const btn = document.getElementById("addBtn");

      if (!playlistId) {
        alert("‡¶¶‡ßü‡¶æ ‡¶ï‡¶∞‡ßá ‡¶™‡ßç‡¶≤‡ßá‡¶≤‡¶ø‡¶∏‡ßç‡¶ü ID ‡¶¶‡¶ø‡¶®!");
        return;
      }

      // ‡ßß. ‡¶≤‡¶æ‡¶á‡¶® ‡¶¨‡¶æ‡¶á ‡¶≤‡¶æ‡¶á‡¶® ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶Ü‡¶≤‡¶æ‡¶¶‡¶æ ‡¶ï‡¶∞‡¶æ
      const lines = videoInput.split('\n');
      let videoIds = [];

      // ‡ß®. ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡¶ø‡¶° ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ID ‡¶¨‡ßá‡¶∞ ‡¶ï‡¶∞‡¶æ
      lines.forEach(line => {
        const match = decodeURIComponent(line).match(/(?:docid=|\/embed\/|v=|\/v\/|youtu\.be\/|\/watch\?v=)([a-zA-Z0-9_-]{11})/);
        if (match) {
          videoIds.push(match[1]);
        }
      });

      if (videoIds.length === 0) {
        alert("‡¶ï‡ßã‡¶®‡ßã ‡¶∏‡¶†‡¶ø‡¶ï ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø!");
        return;
      }

      // ‡ß©. ‡¶™‡ßç‡¶∞‡¶∏‡ßá‡¶∏‡¶ø‡¶Ç ‡¶∂‡ßÅ‡¶∞‡ßÅ
      btn.disabled = true;
      btn.innerText = "Adding...";
      document.getElementById("logArea").innerHTML = ""; // ‡¶≤‡¶ó ‡¶ï‡ßç‡¶≤‡¶ø‡ßü‡¶æ‡¶∞
      addLog(`‡¶Æ‡ßã‡¶ü ${videoIds.length} ‡¶ü‡¶ø ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶ó‡ßá‡¶õ‡ßá‡•§ ‡¶ï‡¶æ‡¶ú ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...`, "processing");

      for (let i = 0; i < videoIds.length; i++) {
        const videoId = videoIds[i];
        addLog(`[${i+1}/${videoIds.length}] ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá... (${videoId})`, "processing");
        
        // API ‡¶ï‡¶≤
        const success = await addToPlaylistApi(playlistId, videoId);
        
        if (success) {
          addLog(`‚úÖ [${i+1}/${videoIds.length}] ‡¶∏‡¶´‡¶≤!`, "success");
        } else {
          addLog(`‚ùå [${i+1}/${videoIds.length}] ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•!`, "error");
        }

        // ‡ß™. ‡¶ó‡ßÅ‡¶ó‡¶≤‡¶ï‡ßá ‡¶¨‡¶ø‡¶∂‡ßç‡¶∞‡¶æ‡¶Æ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ (‡ßß ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶¶‡ßá‡¶∞‡¶ø) - ‡¶®‡¶æ‡¶π‡¶≤‡ßá ‡¶∏‡ßç‡¶™‡ßç‡¶Ø‡¶æ‡¶Æ ‡¶ß‡¶∞‡¶¨‡ßá
        await new Promise(r => setTimeout(r, 1000));
      }

      addLog("üéâ ‡¶∏‡¶¨ ‡¶ï‡¶æ‡¶ú ‡¶∂‡ßá‡¶∑!", "success");
      btn.disabled = false;
      btn.innerText = "Start Adding All ‚ö°";
    }

    async function addToPlaylistApi(playlistId, videoId) {
      try {
        const response = await fetch(`https://www.googleapis.com/youtube/v3/playlistItems?part=snippet`, {
          method: "POST",
          headers: {
            "Authorization": `Bearer ${accessToken}`,
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            snippet: {
              playlistId: playlistId,
              resourceId: {
                kind: "youtube#video",
                videoId: videoId
              }
            }
          })
        });

        if (response.ok) return true;
        else {
          const data = await response.json();
          console.error(data);
          return false;
        }
      } catch (error) {
        return false;
      }
    }

    function addLog(msg, type) {
      const logArea = document.getElementById("logArea");
      const div = document.createElement("div");
      div.className = `log-item ${type}`;
      div.innerText = msg;
      logArea.prepend(div); // ‡¶®‡¶§‡ßÅ‡¶® ‡¶≤‡¶ó ‡¶∏‡¶¨‡¶æ‡¶∞ ‡¶â‡¶™‡¶∞‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá
    }
  </script>
</body>
</html>
