<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Auto Playlist Adder üì∫</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');

    body {
      margin: 0;
      font-family: "Poppins", sans-serif;
      background: linear-gradient(135deg, #0f172a, #1e293b, #334155);
      color: #e2e8f0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      overflow: hidden;
    }

    .glass {
      background: rgba(255, 255, 255, 0.1);
      box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 30px;
      text-align: center;
      width: 90%;
      max-width: 500px;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    h1 { color: #38bdf8; font-weight: 600; margin-bottom: 10px; font-size: 1.5rem; }
    
    .input-group { margin-bottom: 15px; text-align: left; }
    label { font-size: 12px; color: #94a3b8; margin-left: 5px; }

    input, textarea {
      width: 100%;
      padding: 12px;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,0.1);
      background: rgba(0, 0, 0, 0.2);
      color: #fff;
      font-size: 14px;
      margin-top: 5px;
      box-sizing: border-box;
    }
    
    textarea { resize: none; height: 80px; }
    input:focus, textarea:focus { border-color: #38bdf8; outline: none; }

    .btn-container { display: flex; gap: 10px; margin-top: 15px; }

    button {
      flex: 1;
      padding: 12px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 600;
      transition: 0.3s;
    }

    .btn-auth { background: #fff; color: #333; display: flex; align-items: center; justify-content: center; gap: 8px; }
    .btn-add { background: linear-gradient(90deg, #0ea5e9, #38bdf8); color: #0f172a; }
    
    button:hover { transform: translateY(-2px); opacity: 0.9; }
    button:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }

    #status { margin-top: 15px; font-size: 14px; min-height: 20px; }
    .success { color: #4ade80; }
    .error { color: #f87171; }
  </style>
  
  <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body>

  <div class="glass">
    <h1>üì∫ Playlist Manager</h1>

    <div class="input-group">
      <label>‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶ü‡¶æ‡¶∞‡ßç‡¶ó‡ßá‡¶ü ‡¶™‡ßç‡¶≤‡ßá‡¶≤‡¶ø‡¶∏‡ßç‡¶ü ID:</label>
      <input type="text" id="playlistId" placeholder="‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£: PLxA6_w... (ID only)">
    </div>

    <div class="input-group">
      <label>‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶≤‡¶ø‡¶Ç‡¶ï (Embed/Url):</label>
      <textarea id="videoInput" placeholder="‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶™‡ßá‡¶∏‡ßç‡¶ü ‡¶ï‡¶∞‡ßã..."></textarea>
    </div>

    <div class="btn-container">
      <button id="authBtn" class="btn-auth" onclick="handleAuth()">
        <img src="https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg" width="18"> Google Login
      </button>
      <button id="addBtn" class="btn-add" onclick="processVideo()" disabled>
        Add to Playlist üöÄ
      </button>
    </div>

    <div id="status"></div>
  </div>

  <script>
    // ==========================================
    // TODO: ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ Google Cloud Client ID ‡¶¨‡¶∏‡¶æ‡¶ì
    // ==========================================
    const CLIENT_ID = '‡¶§‡ßã‡¶Æ‡¶æ‡¶∞_CLIENT_ID_‡¶è‡¶ñ‡¶æ‡¶®‡ßá_‡¶¨‡¶∏‡¶æ‡¶ì.apps.googleusercontent.com';
    
    let tokenClient;
    let accessToken = null;

    // ‡ßß. ‡¶™‡ßá‡¶ú ‡¶≤‡ßã‡¶° ‡¶π‡¶≤‡ßá ‡¶ó‡ßÅ‡¶ó‡¶≤ ‡¶Ö‡¶•‡ßá‡¶®‡¶ü‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶∏‡ßá‡¶ü‡¶Ü‡¶™
    window.onload = function() {
      tokenClient = google.accounts.oauth2.initTokenClient({
        client_id: CLIENT_ID,
        scope: 'https://www.googleapis.com/auth/youtube',
        callback: (tokenResponse) => {
          if (tokenResponse && tokenResponse.access_token) {
            accessToken = tokenResponse.access_token;
            document.getElementById("authBtn").innerText = "Logged In ‚úÖ";
            document.getElementById("authBtn").style.background = "#4ade80";
            document.getElementById("addBtn").disabled = false;
            document.getElementById("status").innerText = "‡¶∞‡ßá‡¶°‡¶ø! ‡¶è‡¶ñ‡¶® ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶¶‡¶ø‡ßü‡ßá Add ‡¶¨‡¶æ‡¶ü‡¶® ‡¶ö‡¶æ‡¶™‡ßÅ‡¶®‡•§";
            document.getElementById("status").className = "success";
          }
        },
      });
    };

    // ‡ß®. ‡¶≤‡¶ó‡¶ø‡¶® ‡¶¨‡¶æ‡¶ü‡¶® ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
    function handleAuth() {
      if (accessToken) return;
      tokenClient.requestAccessToken();
    }

    // ‡ß©. ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶™‡ßç‡¶∞‡¶∏‡ßá‡¶∏‡¶ø‡¶Ç ‡¶è‡¶¨‡¶Ç ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶ï‡¶∞‡¶æ
    async function processVideo() {
      const videoInput = document.getElementById("videoInput").value;
      const playlistId = document.getElementById("playlistId").value.trim();
      const statusDiv = document.getElementById("status");

      if (!playlistId) {
        showStatus("‚ùå ‡¶¶‡ßü‡¶æ ‡¶ï‡¶∞‡ßá ‡¶™‡ßç‡¶≤‡ßá‡¶≤‡¶ø‡¶∏‡ßç‡¶ü ID ‡¶¶‡¶ø‡¶®!", "error");
        return;
      }

      // ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ID ‡¶¨‡ßá‡¶∞ ‡¶ï‡¶∞‡¶æ (Regex)
      const match = decodeURIComponent(videoInput).match(/(?:docid=|\/embed\/|v=|\/v\/|youtu\.be\/|\/watch\?v=)([a-zA-Z0-9_-]{11})/);
      
      if (!match) {
        showStatus("‚ùå ‡¶ï‡ßã‡¶®‡ßã ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ID ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø!", "error");
        return;
      }

      const videoId = match[1];
      showStatus("‚è≥ ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶™‡ßç‡¶∞‡¶∏‡ßá‡¶∏‡¶ø‡¶Ç ‡¶π‡¶ö‡ßç‡¶õ‡ßá...", "success");

      // API ‡¶ï‡¶≤ ‡¶ï‡¶∞‡¶æ
      addToPlaylistApi(playlistId, videoId);
    }

    // ‡ß™. ‡¶á‡¶â‡¶ü‡¶ø‡¶â‡¶¨ API ‡¶ï‡¶≤
    async function addToPlaylistApi(playlistId, videoId) {
      try {
        const response = await fetch(`https://www.googleapis.com/youtube/v3/playlistItems?part=snippet`, {
          method: "POST",
          headers: {
            "Authorization": `Bearer ${accessToken}`,
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            snippet: {
              playlistId: playlistId,
              resourceId: {
                kind: "youtube#video",
                videoId: videoId
              }
            }
          })
        });

        const data = await response.json();

        if (response.ok) {
          showStatus(`‚úÖ ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶™‡ßç‡¶≤‡ßá‡¶≤‡¶ø‡¶∏‡ßç‡¶ü‡ßá ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶π‡ßü‡ßá‡¶õ‡ßá!`, "success");
          document.getElementById("videoInput").value = ""; // ‡¶á‡¶®‡¶™‡ßÅ‡¶ü ‡¶ï‡ßç‡¶≤‡¶ø‡ßü‡¶æ‡¶∞
        } else {
          console.error(data);
          showStatus(`‚ùå ‡¶è‡¶∞‡¶∞: ${data.error.message}`, "error");
        }
      } catch (error) {
        showStatus("‚ùå ‡¶®‡ßá‡¶ü‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶ï ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ!", "error");
      }
    }

    function showStatus(msg, type) {
      const el = document.getElementById("status");
      el.innerText = msg;
      el.className = type;
    }
  </script>
</body>
</html>